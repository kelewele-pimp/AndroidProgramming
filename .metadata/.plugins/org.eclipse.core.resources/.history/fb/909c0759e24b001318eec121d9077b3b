package Fragments;

import java.io.InputStream;
import java.net.HttpURLConnection;
import java.net.URL;
import java.net.URLConnection;
import java.util.ArrayList;

import javax.xml.parsers.DocumentBuilder;
import javax.xml.parsers.DocumentBuilderFactory;

import org.w3c.dom.Document;

import Model.Quake;
import android.app.ListFragment;
import android.os.Bundle;
import android.os.Handler;
import android.widget.ArrayAdapter;

public class EarthquakeListFragment extends ListFragment {

	ArrayAdapter<Quake> adapter; 
	ArrayList<Quake> earthQuakes = new ArrayList<Quake>();
	
	private static final String TAG = "EARTHQUAKE"; 
	private Handler handler = new Handler(); 
	
	@Override
	public void onActivityCreated(Bundle savedInstanceState) {
		super.onActivityCreated(savedInstanceState);
		int layoutID = android.R.layout.simple_list_item_1; 
		adapter = new ArrayAdapter<Quake>(getActivity(), layoutID, earthQuakes); 
		setListAdapter(adapter);
	}
	
	public void refreshEarthquakes(){
		//Get the XML
		URL url; 
		try {
			String quakeFeed = getString(com.example.earthquake.R.string.quake_feed);
			url = new URL(quakeFeed); 
			
			URLConnection connection = url.openConnection(); 
			
			HttpURLConnection httpConnection = (HttpURLConnection) connection; 
			int responseCode = httpConnection.getResponseCode(); 
			
			if(responseCode == HttpURLConnection.HTTP_OK){
				InputStream in = httpConnection.getInputStream(); 
				
				//NEW DOM PARSING INSTANCE
				DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance(); 
				DocumentBuilder db = dbf.newDocumentBuilder(); 
				
				//Parse the eartqauke feed 
				Document dom = db.parse(in); 
			}
		} catch (Exception e) {
			// TODO: handle exception
		}
	}
	
}
